name: GitHub Classroom Workflow

on: [push]
env: 
      BUILD_TYPE: Release 

jobs:
      build:
        name: Autograding
        runs-on: ubuntu-latest
        strategy:
              max-parallel: 1
        steps:
          - uses: actions/checkout@v2
          - uses : hikmatfarhat-ndu/my_autograding@main
          - uses: actions/upload-artifact@v2
            with:
                  name: report
                  path: report.md
         # - uses: EndBug/add-and-commit@v5
         #   with:
         #      add: "*"
         #   env: 
         #       GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}  
      status:
        name: status
        runs-on: ubuntu-latest
        needs: [build]
        #if: "!contains(github.event.head_commit.message, 'GitHub')"
        # for some reason the below does not work
        #if: "!contains(github.event.actor,'github-classroom')"
        if : github.event.run_number > 4
        steps:
              - uses: actions/checkout@v2
              #- name: environ
              #  run: env
              - uses: actions/download-artifact@v2
                with:
                      name: report
              - name: status
                run: sh status.sh
                env:
                  GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
              
